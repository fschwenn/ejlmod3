# -*- coding: UTF-8 -*-
#program to harvest individual articles from APS
# FS 2012-06-01
# FS 2023-09-22

import os
import ejlmod3
import re
import sys
import unicodedata
import string
import time
 
import urllib.request, urllib.error, urllib.parse
import urllib.parse
from bs4 import BeautifulSoup

skipalreadyharvested = True
skipalreadyharvested = False

tmpdir = '/tmp'
def tfstrip(x): return x.strip()


bunchsize = 10
sleeptime = 33
corethreshold = 15

publisher = 'APS'
#jnl = sys.argv[1]
#vol = sys.argv[2]
#issue = sys.argv[3]
#jnlfilename = jnl+vol+'.'+issue


sample = {'10.1103/RevModPhys.82.1225' : {'all' :     508, 'core' :       92},
          '10.1103/RevModPhys.91.015006' : {'all' :     469, 'core' :       84},
          '10.1103/PhysRevX.8.031079' : {'all' :     432, 'core' :       59},
          '10.1103/revmodphys.87.637' : {'all' :     383, 'core' :      111},
          '10.1103/RevModPhys.87.637' : {'all' :     383, 'core' :      111},
          '10.1103/PhysRevLett.120.146402' : {'all' :     307, 'core' :       29},
          '10.1103/PhysRevLett.123.066404' : {'all' :     304, 'core' :       30},
          '10.1103/RevModPhys.89.015001' : {'all' :     292, 'core' :      124},
          '10.1103/RevModPhys.91.045001' : {'all' :     290, 'core' :      150},
          '10.1103/RevModPhys.85.553' : {'all' :     222, 'core' :       57},
          '10.1103/RevModPhys.83.1405' : {'all' :     222, 'core' :       47},
          '10.1103/RevModPhys.87.1379' : {'all' :     221, 'core' :      111},
          '10.1103/RevModPhys.84.1655' : {'all' :     208, 'core' :       94},
          '10.1103/PhysRevLett.123.170401' : {'all' :     206, 'core' :       31},
          '10.1103/RevModPhys.87.347' : {'all' :     199, 'core' :       68},
          '10.1103/RevModPhys.85.961' : {'all' :     190, 'core' :      122},
          '10.1103/physrevx.8.031022' : {'all' :     181, 'core' :      152},
          '10.1103/PhysRevX.8.031022' : {'all' :     181, 'core' :      152},
          '10.1103/PhysRevB.97.205136' : {'all' :     174, 'core' :       11},
          '10.1103/RevModPhys.89.015006' : {'all' :     163, 'core' :       67},
          '10.1103/PhysRevLett.118.045701' : {'all' :     161, 'core' :       22},
          '10.1103/RevModPhys.90.031002' : {'all' :     157, 'core' :       50},
          '10.1103/RevModPhys.93.025003' : {'all' :     150, 'core' :       51},
          '10.1103/RevModPhys.88.021004' : {'all' :     150, 'core' :       29},
          '10.1103/RevModPhys.84.1419' : {'all' :     139, 'core' :       21},
          '10.1103/PhysRevLett.119.136803' : {'all' :     139, 'core' :       11},
          '10.1103/RevModPhys.86.361' : {'all' :     137, 'core' :       87},
          '10.1103/RevModPhys.90.035006' : {'all' :     136, 'core' :       62},
          '10.1103/RevModPhys.85.1191' : {'all' :     136, 'core' :       35},
          '10.1103/PhysRevResearch.2.023265' : {'all' :     128, 'core' :       19},
          '10.1103/RevModPhys.89.021001' : {'all' :     126, 'core' :       48},
          '10.1103/PhysRevX.7.031024' : {'all' :     124, 'core' :       26},
          '10.1103/PhysRevResearch.1.023013' : {'all' :     123, 'core' :       17},
          '10.1103/PhysRevA.98.012324' : {'all' :     123, 'core' :      106},
          '10.1103/PhysRevLett.122.237601' : {'all' :     120, 'core' :       14},
          '10.1103/PhysRevX.6.031006' : {'all' :     118, 'core' :      100},
          '10.1103/PRXQuantum.2.017002' : {'all' :     117, 'core' :       82},
          '10.1103/physreva.98.022322' : {'all' :     117, 'core' :      106},
          '10.1103/PhysRevA.98.022322' : {'all' :     117, 'core' :      106},
          '10.1103/RevModPhys.85.1633' : {'all' :     116, 'core' :       28},
          '10.1103/PhysRevX.5.041041' : {'all' :     113, 'core' :       54},
          '10.1103/PhysRevLett.125.186802' : {'all' :     112, 'core' :       15},
          '10.1103/PhysRevB.100.054301' : {'all' :     107, 'core' :       10},
          '10.1103/PhysRevLett.122.127202' : {'all' :     103, 'core' :       20},
          '10.1103/RevModPhys.83.1193' : {'all' :     101, 'core' :       22},
          '10.1103/RevModPhys.87.1419' : {'all' :      99, 'core' :       52},
          '10.1103/PhysRevResearch.2.033429' : {'all' :      95, 'core' :       33},
          '10.1103/PhysRevX.7.021003' : {'all' :      93, 'core' :       33},
          '10.1103/PhysRevB.99.081302' : {'all' :      93, 'core' :       10},
          '10.1103/RevModPhys.83.349' : {'all' :      92, 'core' :       29},
          '10.1103/PhysRevB.98.035141' : {'all' :      91, 'core' :       10},
          '10.1103/PhysRevX.9.041041' : {'all' :      90, 'core' :       71},
          '10.1103/PhysRevLett.119.020602' : {'all' :      90, 'core' :       17},
          '10.1103/PhysRevB.99.121101' : {'all' :      90, 'core' :       12},
          '10.1103/PhysRevLett.100.175702' : {'all' :      87, 'core' :       18},
          '10.1103/PhysRevLett.120.113901' : {'all' :      87, 'core' :       10},
          '10.1103/PhysRevLett.124.250402' : {'all' :      85, 'core' :       11},
          '10.1103/PhysRevB.99.041406' : {'all' :      85, 'core' :       11},
          '10.1103/PhysRevLett.119.260401' : {'all' :      84, 'core' :       11},
          '10.1103/RevModPhys.88.041001' : {'all' :      82, 'core' :       53},
          '10.1103/PhysRevResearch.2.023358' : {'all' :      79, 'core' :       34},
          '10.1103/RevModPhys.92.035005' : {'all' :      79, 'core' :       32},
          '10.1103/PRXQuantum.1.020101' : {'all' :      78, 'core' :       47},
          '10.1103/PhysRevE.95.062122' : {'all' :      77, 'core' :       30},
          '10.1103/PhysRevX.7.011034' : {'all' :      77, 'core' :       17},
          '10.1103/PhysRevX.11.011015' : {'all' :      74, 'core' :       23},
          '10.1103/PhysRevLett.110.035302' : {'all' :      73, 'core' :       12},
          '10.1103/PhysRevLett.120.243601' : {'all' :      71, 'core' :       36},
          '10.1103/PhysRevX.8.041055' : {'all' :      71, 'core' :       30},
          '10.1103/PhysRevB.23.5048' : {'all' :      71, 'core' :       15},
          '10.1103/RevModPhys.89.035004' : {'all' :      70, 'core' :       24},
          '10.1103/PhysRevB.101.195147' : {'all' :      69, 'core' :       10},
          '10.1103/PhysRevX.9.021012' : {'all' :      68, 'core' :       13},
          '10.1103/PhysRevLett.122.130405' : {'all' :      68, 'core' :       11},
          '10.1103/PhysRevX.6.031015' : {'all' :      67, 'core' :       54},
          '10.1103/PhysRevX.9.031053' : {'all' :      67, 'core' :       28},
          '10.1103/PhysRevX.5.041047' : {'all' :      67, 'core' :       27},
          '10.1103/PhysRevA.98.022321' : {'all' :      65, 'core' :       58},
          '10.1103/PhysRevX.8.031084' : {'all' :      65, 'core' :       43},
          '10.1103/PRXQuantum.2.030203' : {'all' :      65, 'core' :       36},
          '10.1103/PhysRevLett.122.020501' : {'all' :      63, 'core' :       11},
          '10.1103/RevModPhys.90.025004' : {'all' :      62, 'core' :       25},
          '10.1103/PhysRevResearch.2.023286' : {'all' :      62, 'core' :       23},
          '10.1103/RevModPhys.88.045008' : {'all' :      60, 'core' :       14},
          '10.1103/RevModPhys.92.041002' : {'all' :      59, 'core' :       21},
          '10.1103/PhysRevX.9.011051' : {'all' :      59, 'core' :       10},
          '10.1103/PhysRevX.10.031050' : {'all' :      58, 'core' :       28},
          '10.1103/PhysRevA.98.053819' : {'all' :      58, 'core' :       20},
          '10.1103/PhysRevLett.123.180501' : {'all' :      57, 'core' :       17},
          '10.1103/PhysRevLett.121.040503' : {'all' :      57, 'core' :       17},
          '10.1103/PhysRevLett.121.040603' : {'all' :      57, 'core' :       11},
          '10.1103/PhysRevX.8.031037' : {'all' :      56, 'core' :       24},
          '10.1103/PhysRevLett.106.130401' : {'all' :      56, 'core' :       13},
          '10.1103/PhysRevLett.126.043602' : {'all' :      56, 'core' :       12},
          '10.1103/PhysRevX.10.021051' : {'all' :      56, 'core' :       11},
          '10.1103/PhysRevLett.124.213604' : {'all' :      55, 'core' :       12},
          '10.1103/PhysRevB.102.115109' : {'all' :      54, 'core' :       18},
          '10.1103/PhysRevA.99.062103' : {'all' :      53, 'core' :       10},
          '10.1103/PhysRevX.10.031002' : {'all' :      52, 'core' :       22},
          '10.1103/PhysRevLett.119.253601' : {'all' :      52, 'core' :       22},
          '10.1103/PhysRevLett.120.030402' : {'all' :      52, 'core' :       15},
          '10.1103/RevModPhys.91.035005' : {'all' :      52, 'core' :       11},
          '10.1103/PhysRevResearch.1.033144' : {'all' :      51, 'core' :       13},
          '10.1103/PhysRevResearch.2.043014' : {'all' :      51, 'core' :       12},
          '10.1103/PhysRevLett.121.163601' : {'all' :      51, 'core' :       11},
          '10.1103/PhysRevB.102.100202' : {'all' :      51, 'core' :       11},
          '10.1103/PhysRevResearch.2.033347' : {'all' :      50, 'core' :       28},
          '10.1103/PhysRevLett.120.103201' : {'all' :      50, 'core' :       20},
          '10.1103/RevModPhys.84.1045' : {'all' :      50, 'core' :       15},
          '10.1103/PhysRevLett.120.180602' : {'all' :      50, 'core' :       12},
          '10.1103/PhysRevX.11.021036' : {'all' :      49, 'core' :       14},
          '10.1103/PhysRevX.10.031016' : {'all' :      49, 'core' :       10},
          '10.1103/PhysRevX.2.031007' : {'all' :      48, 'core' :       46},
          '10.1103/PhysRevLett.119.220601' : {'all' :      48, 'core' :       17},
          '10.1103/PhysRevLett.122.223203' : {'all' :      48, 'core' :       16},
          '10.1103/RevModPhys.91.035001' : {'all' :      48, 'core' :       14},
          '10.1103/PhysRevLett.123.090402' : {'all' :      48, 'core' :       14},
          '10.1103/PhysRevB.101.174308' : {'all' :      48, 'core' :       14},
          '10.1103/PhysRevB.99.035115' : {'all' :      48, 'core' :       13},
          '10.1103/PhysRevB.101.165139' : {'all' :      48, 'core' :       13},
          '10.1103/PhysRevB.96.020403' : {'all' :      48, 'core' :       12},
          '10.1103/PhysRevB.102.224303' : {'all' :      48, 'core' :       10},
          '10.1103/PhysRevLett.113.237203' : {'all' :      47, 'core' :       20},
          '10.1103/PhysRevLett.119.123601' : {'all' :      47, 'core' :       16},
          '10.1103/PhysRevResearch.1.033021' : {'all' :      47, 'core' :       13},
          '10.1103/PhysRevLett.121.033602' : {'all' :      47, 'core' :       11},
          '10.1103/PhysRevLett.119.023001' : {'all' :      47, 'core' :       11},
          '10.1103/PRXQuantum.2.010333' : {'all' :      46, 'core' :       42},
          '10.1103/RevModPhys.85.79' : {'all' :      46, 'core' :       20},
          '10.1103/PhysRevLett.120.060409' : {'all' :      46, 'core' :       14},
          '10.1103/PhysRevLett.121.107202' : {'all' :      46, 'core' :       11},
          '10.1103/PhysRevX.10.021021' : {'all' :      44, 'core' :       23},
          '10.1103/PhysRevX.8.021022' : {'all' :      44, 'core' :       21},
          '10.1103/PhysRevLett.120.240503' : {'all' :      44, 'core' :       21},
          '10.1103/PhysRevX.8.011015' : {'all' :      44, 'core' :       17},
          '10.1103/PhysRevX.8.031025' : {'all' :      44, 'core' :       14},
          '10.1103/PhysRevLett.120.040602' : {'all' :      44, 'core' :       14},
          '10.1103/PhysRevX.8.041033' : {'all' :      44, 'core' :       13},
          '10.1103/PhysRevA.103.062226' : {'all' :      44, 'core' :       12},
          '10.1103/PhysRevB.102.054206' : {'all' :      44, 'core' :       10},
          '10.1103/PhysRevX.9.011034' : {'all' :      43, 'core' :       18},
          '10.1103/PhysRevA.103.023710' : {'all' :      43, 'core' :       16},
          '10.1103/PhysRevLett.123.036403' : {'all' :      43, 'core' :       15},
          '10.1103/PhysRevLett.124.163604' : {'all' :      43, 'core' :       13},
          '10.1103/PhysRevLett.121.070601' : {'all' :      43, 'core' :       11},
          '10.1103/PhysRevX.9.041014' : {'all' :      43, 'core' :       10},
          '10.1103/PhysRevLett.124.130601' : {'all' :      42, 'core' :       17},
          '10.1103/PhysRevLett.123.180602' : {'all' :      42, 'core' :       16},
          '10.1103/PhysRevLett.126.090401' : {'all' :      42, 'core' :       15},
          '10.1103/PhysRevA.101.012103' : {'all' :      42, 'core' :       14},
          '10.1103/PhysRevLett.126.123402' : {'all' :      42, 'core' :       12},
          '10.1103/PhysRevLett.121.225303' : {'all' :      42, 'core' :       10},
          '10.1103/PhysRevA.96.043811' : {'all' :      42, 'core' :       10},
          '10.1103/PRXQuantum.2.010101' : {'all' :      41, 'core' :       38},
          '10.1103/PhysRevResearch.2.022060' : {'all' :      41, 'core' :       35},
          '10.1103/PhysRevResearch.2.013095' : {'all' :      41, 'core' :       19},
          '10.1103/PhysRevLett.121.033902' : {'all' :      41, 'core' :       16},
          '10.1103/PhysRevX.8.031029' : {'all' :      41, 'core' :       13},
          '10.1103/PhysRevA.97.013851' : {'all' :      40, 'core' :       16},
          '10.1103/PhysRevLett.120.173601' : {'all' :      40, 'core' :       15},
          '10.1103/PhysRevX.8.011032' : {'all' :      40, 'core' :       13},
          '10.1103/PhysRevLett.125.230604' : {'all' :      40, 'core' :       13},
          '10.1103/PhysRevLett.121.063601' : {'all' :      40, 'core' :       12},
          '10.1103/PhysRevLett.119.150405' : {'all' :      40, 'core' :       11},
          '10.1103/PhysRevA.101.063838' : {'all' :      40, 'core' :       10},
          '10.1103/PhysRevB.95.245134' : {'all' :      39, 'core' :       18},
          '10.1103/PhysRevLett.125.080402' : {'all' :      39, 'core' :       17},
          '10.1103/PhysRevLett.123.160501' : {'all' :      39, 'core' :       16},
          '10.1103/PhysRevLett.124.063601' : {'all' :      39, 'core' :       15},
          '10.1103/PhysRevLett.122.140403' : {'all' :      39, 'core' :       15},
          '10.1103/PhysRevLett.125.230603' : {'all' :      39, 'core' :       14},
          '10.1103/PhysRevA.100.042116' : {'all' :      39, 'core' :       14},
          '10.1103/PhysRevResearch.2.043346' : {'all' :      39, 'core' :       13},
          '10.1103/PhysRevResearch.2.022065' : {'all' :      39, 'core' :       13},
          '10.1103/PhysRevLett.119.170602' : {'all' :      39, 'core' :       12},
          '10.1103/PhysRevLett.122.143901' : {'all' :      39, 'core' :       11},
          '10.1103/PhysRevLett.121.213201' : {'all' :      39, 'core' :       11},
          '10.1103/PhysRevLett.121.130603' : {'all' :      39, 'core' :       10},
          '10.1103/PhysRevB.97.245122' : {'all' :      39, 'core' :       10},
          '10.1103/PhysRevLett.120.240501' : {'all' :      38, 'core' :       23},
          '10.1103/PhysRevLett.122.130402' : {'all' :      38, 'core' :       20},
          '10.1103/PhysRevApplied.13.034068' : {'all' :      38, 'core' :       19},
          '10.1103/PhysRevLett.120.200604' : {'all' :      38, 'core' :       16},
          '10.1103/PhysRevLett.120.180502' : {'all' :      38, 'core' :       15},
          '10.1103/PhysRevLett.120.240403' : {'all' :      38, 'core' :       14},
          '10.1103/PhysRevLett.124.013601' : {'all' :      38, 'core' :       13},
          '10.1103/PhysRevLett.121.053601' : {'all' :      38, 'core' :       12},
          '10.1103/PhysRevB.102.075123' : {'all' :      38, 'core' :       12},
          '10.1103/PhysRevB.99.121112' : {'all' :      38, 'core' :       11},
          '10.1103/PhysRevA.97.022104' : {'all' :      38, 'core' :       11},
          '10.1103/PhysRevLett.123.223602' : {'all' :      38, 'core' :       10},
          '10.1103/PhysRevLett.122.015701' : {'all' :      38, 'core' :       10},
          '10.1103/PhysRevLett.119.143602' : {'all' :      38, 'core' :       10},
          '10.1103/PhysRevX.8.021063' : {'all' :      37, 'core' :       18},
          '10.1103/PhysRevLett.119.010403' : {'all' :      37, 'core' :       17},
          '10.1103/PhysRevLett.125.240405' : {'all' :      37, 'core' :       16},
          '10.1103/PhysRevX.11.021021' : {'all' :      37, 'core' :       15},
          '10.1103/PhysRevLett.125.223401' : {'all' :      37, 'core' :       14},
          '10.1103/PhysRevLett.120.257204' : {'all' :      37, 'core' :       14},
          '10.1103/PhysRevLett.119.053202' : {'all' :      37, 'core' :       14},
          '10.1103/PhysRevE.104.L012103' : {'all' :      37, 'core' :       14},
          '10.1103/PhysRevLett.123.040401' : {'all' :      37, 'core' :       13},
          '10.1103/PhysRevX.9.011021' : {'all' :      37, 'core' :       12},
          '10.1103/PhysRevLett.121.024101' : {'all' :      37, 'core' :       12},
          '10.1103/PhysRevB.98.035139' : {'all' :      37, 'core' :       12},
          '10.1103/PhysRevLett.124.043603' : {'all' :      37, 'core' :       11},
          '10.1103/PhysRevE.102.052109' : {'all' :      37, 'core' :       11},
          '10.1103/PhysRevLett.120.163601' : {'all' :      37, 'core' :       10},
          '10.1103/PhysRevA.97.043820' : {'all' :      37, 'core' :       10},
          '10.1103/PhysRevLett.114.243002' : {'all' :      36, 'core' :       19},
          '10.1103/PhysRevLett.122.090503' : {'all' :      36, 'core' :       17},
          '10.1103/PhysRevX.11.011047' : {'all' :      36, 'core' :       16},
          '10.1103/PhysRevLett.125.153602' : {'all' :      36, 'core' :       12},
          '10.1103/PhysRevLett.124.097201' : {'all' :      36, 'core' :       12},
          '10.1103/PhysRevX.11.011011' : {'all' :      36, 'core' :       11},
          '10.1103/PhysRevLett.122.070601' : {'all' :      36, 'core' :       11},
          '10.1103/PhysRevB.99.054404' : {'all' :      36, 'core' :       11},
          '10.1103/PhysRevX.11.041021' : {'all' :      36, 'core' :       10},
          '10.1103/PhysRevLett.120.070602' : {'all' :      36, 'core' :       10},
          '10.1103/PhysRevB.98.085425' : {'all' :      36, 'core' :       10},
          '10.1103/PhysRevB.97.214205' : {'all' :      36, 'core' :       10},
          '10.1103/PhysRevA.98.032310' : {'all' :      35, 'core' :       19},
          '10.1103/PhysRevLett.121.183603' : {'all' :      35, 'core' :       18},
          '10.1103/PhysRevApplied.11.044014' : {'all' :      35, 'core' :       18},
          '10.1103/PhysRevX.9.011057' : {'all' :      35, 'core' :       17},
          '10.1103/PhysRevResearch.2.033475' : {'all' :      35, 'core' :       17},
          '10.1103/PhysRevApplied.11.064053' : {'all' :      35, 'core' :       14},
          '10.1103/PhysRevLett.126.083602' : {'all' :      35, 'core' :       13},
          '10.1103/PhysRevLett.124.110601' : {'all' :      35, 'core' :       13},
          '10.1103/PhysRevLett.126.170506' : {'all' :      35, 'core' :       12},
          '10.1103/PhysRevLett.123.230603' : {'all' :      35, 'core' :       11},
          '10.1103/PhysRevLett.120.120602' : {'all' :      35, 'core' :       11},
          '10.1103/PhysRevE.100.032117' : {'all' :      35, 'core' :       11},
          '10.1103/PhysRevB.102.075127' : {'all' :      35, 'core' :       11},
          '10.1103/PhysRevLett.120.185301' : {'all' :      35, 'core' :       10},
          '10.1103/PhysRevLett.123.070501' : {'all' :      34, 'core' :       21},
          '10.1103/PhysRevA.100.022341' : {'all' :      34, 'core' :       20},
          '10.1103/PhysRevLett.122.160401' : {'all' :      34, 'core' :       18},
          '10.1103/PhysRevB.98.075201' : {'all' :      34, 'core' :       18},
          '10.1103/PhysRevX.8.021033' : {'all' :      34, 'core' :       17},
          '10.1103/PhysRevB.100.174103' : {'all' :      34, 'core' :       17},
          '10.1103/PhysRevLett.124.023201' : {'all' :      34, 'core' :       14},
          '10.1103/PhysRevLett.122.190405' : {'all' :      34, 'core' :       14},
          '10.1103/PhysRevLett.122.053603' : {'all' :      34, 'core' :       14},
          '10.1103/PhysRevX.8.041038' : {'all' :      34, 'core' :       11},
          '10.1103/PhysRevResearch.2.042033' : {'all' :      34, 'core' :       11},
          '10.1103/PhysRevA.99.063834' : {'all' :      34, 'core' :       11},
          '10.1103/PhysRevA.96.062103' : {'all' :      34, 'core' :       11},
          '10.1103/PhysRevA.101.062315' : {'all' :      34, 'core' :       11},
          '10.1103/PhysRevB.102.144306' : {'all' :      34, 'core' :       10},
          '10.1103/PhysRevA.98.022303' : {'all' :      34, 'core' :       10},
          '10.1103/PhysRevLett.103.020504' : {'all' :      33, 'core' :       21},
          '10.1103/PhysRevA.103.032216' : {'all' :      33, 'core' :       16},
          '10.1103/PhysRevLett.119.176803' : {'all' :      33, 'core' :       15},
          '10.1103/PhysRevResearch.2.033111' : {'all' :      33, 'core' :       14},
          '10.1103/PhysRevLett.120.010503' : {'all' :      33, 'core' :       14},
          '10.1103/PhysRevLett.119.090603' : {'all' :      33, 'core' :       14},
          '10.1103/PhysRevB.97.125404' : {'all' :      33, 'core' :       14},
          '10.1103/PhysRevLett.120.033601' : {'all' :      33, 'core' :       12},
          '10.1103/PhysRevA.103.L020201' : {'all' :      33, 'core' :       12},
          '10.1103/PhysRevLett.125.100402' : {'all' :      33, 'core' :       11},
          '10.1103/PhysRevLett.123.090605' : {'all' :      33, 'core' :       11},
          '10.1103/PhysRevLett.120.063601' : {'all' :      33, 'core' :       11},
          '10.1103/PhysRevE.99.042105' : {'all' :      33, 'core' :       11},
          '10.1103/PhysRevB.101.014419' : {'all' :      33, 'core' :       11},
          '10.1103/PhysRevLett.123.163601' : {'all' :      33, 'core' :       10},
          '10.1103/PhysRevLett.121.110502' : {'all' :      33, 'core' :       10},
          '10.1103/PhysRevB.99.165121' : {'all' :      33, 'core' :       10},
          '10.1103/PhysRevB.97.134109' : {'all' :      33, 'core' :       10},
          '10.1103/PhysRevB.102.125134' : {'all' :      33, 'core' :       10},
          '10.1103/PRXQuantum.2.020341' : {'all' :      32, 'core' :       29},
          '10.1103/PhysRevApplied.10.044033' : {'all' :      32, 'core' :       19},
          '10.1103/PhysRevLett.124.013602' : {'all' :      32, 'core' :       18},
          '10.1103/PhysRevLett.124.063605' : {'all' :      32, 'core' :       17},
          '10.1103/PhysRevLett.124.120401' : {'all' :      32, 'core' :       15},
          '10.1103/PhysRevB.98.085155' : {'all' :      32, 'core' :       15},
          '10.1103/PhysRevX.11.011035' : {'all' :      32, 'core' :       14},
          '10.1103/PhysRevLett.121.230801' : {'all' :      32, 'core' :       14},
          '10.1103/PhysRevLett.120.140402' : {'all' :      32, 'core' :       14},
          '10.1103/PhysRevA.103.022210' : {'all' :      32, 'core' :       14},
          '10.1103/PhysRevX.9.021056' : {'all' :      32, 'core' :       13},
          '10.1103/PhysRevLett.126.063602' : {'all' :      32, 'core' :       13},
          '10.1103/PhysRevLett.125.170603' : {'all' :      32, 'core' :       13},
          '10.1103/PhysRevA.98.053834' : {'all' :      32, 'core' :       13},
          '10.1103/PhysRevX.10.041049' : {'all' :      32, 'core' :       11},
          '10.1103/PhysRevE.97.062108' : {'all' :      32, 'core' :       11},
          '10.1103/PhysRevB.98.155438' : {'all' :      32, 'core' :       11},
          '10.1103/PhysRevA.98.052129' : {'all' :      32, 'core' :       11},
          '10.1103/PhysRevA.97.013853' : {'all' :      32, 'core' :       11},
          '10.1103/PhysRevLett.126.153603' : {'all' :      32, 'core' :       10},
          '10.1103/PhysRevLett.123.140503' : {'all' :      32, 'core' :       10},
          '10.1103/PhysRevB.103.L100202' : {'all' :      32, 'core' :       10},
          '10.1103/PhysRevB.101.245148' : {'all' :      32, 'core' :       10},
          '10.1103/PhysRevLett.124.030501' : {'all' :      31, 'core' :       19},
          '10.1103/PhysRevLett.127.060504' : {'all' :      31, 'core' :       17},
          '10.1103/PhysRevLett.112.140407' : {'all' :      31, 'core' :       17},
          '10.1103/PhysRevLett.119.170503' : {'all' :      31, 'core' :       16},
          '10.1103/PhysRevLett.124.020501' : {'all' :      31, 'core' :       15},
          '10.1103/PhysRevLett.119.190501' : {'all' :      31, 'core' :       15},
          '10.1103/PhysRevApplied.8.024026' : {'all' :      31, 'core' :       15},
          '10.1103/PhysRevA.98.012142' : {'all' :      31, 'core' :       15},
          '10.1103/PhysRevLett.125.117701' : {'all' :      31, 'core' :       14},
          '10.1103/PhysRevLett.123.150401' : {'all' :      31, 'core' :       14},
          '10.1103/PhysRevLett.126.220404' : {'all' :      31, 'core' :       13},
          '10.1103/PhysRevA.101.052108' : {'all' :      31, 'core' :       13},
          '10.1103/PhysRevLett.123.253601' : {'all' :      31, 'core' :       12},
          '10.1103/PhysRevA.96.032316' : {'all' :      31, 'core' :       10},
          '10.1103/PhysRevLett.124.030601' : {'all' :      30, 'core' :       19},
          '10.1103/PhysRevB.96.195136' : {'all' :      30, 'core' :       19},
          '10.1103/PhysRevA.99.042327' : {'all' :      30, 'core' :       18},
          '10.1103/PhysRevA.98.012305' : {'all' :      30, 'core' :       18},
          '10.1103/PhysRevB.104.115425' : {'all' :      30, 'core' :       16},
          '10.1103/PRXQuantum.2.020307' : {'all' :      30, 'core' :       14},
          '10.1103/PhysRevLett.123.140402' : {'all' :      30, 'core' :       14},
          '10.1103/PhysRevLett.120.183601' : {'all' :      30, 'core' :       14},
          '10.1103/PhysRevLett.119.230401' : {'all' :      30, 'core' :       14},
          '10.1103/PhysRevLett.124.220601' : {'all' :      30, 'core' :       12},
          '10.1103/PhysRevE.98.042122' : {'all' :      30, 'core' :       12},
          '10.1103/PhysRevB.99.155150' : {'all' :      30, 'core' :       12},
          '10.1103/PhysRevLett.128.223202' : {'all' :      30, 'core' :       11},
          '10.1103/PhysRevLett.123.233602' : {'all' :      30, 'core' :       11},
          '10.1103/PhysRevB.99.104205' : {'all' :      30, 'core' :       11},
          '10.1103/PhysRevX.10.031040' : {'all' :      30, 'core' :       10},
          '10.1103/PhysRevApplied.9.064031' : {'all' :      29, 'core' :       19},
          '10.1103/PhysRevLett.124.070503' : {'all' :      29, 'core' :       18},
          '10.1103/PhysRevA.99.043404' : {'all' :      29, 'core' :       18},
          '10.1103/PhysRevA.97.042316' : {'all' :      29, 'core' :       18},
          '10.1103/PhysRevA.99.022305' : {'all' :      29, 'core' :       17},
          '10.1103/PhysRevLett.126.057702' : {'all' :      29, 'core' :       14},
          '10.1103/PhysRevLett.124.163603' : {'all' :      29, 'core' :       14},
          '10.1103/PhysRevLett.120.230502' : {'all' :      29, 'core' :       14},
          '10.1103/PhysRevX.10.011018' : {'all' :      29, 'core' :       13},
          '10.1103/PhysRevB.99.155131' : {'all' :      29, 'core' :       13},
          '10.1103/PhysRevB.105.125123' : {'all' :      29, 'core' :       13},
          '10.1103/PhysRevA.102.012206' : {'all' :      29, 'core' :       13},
          '10.1103/PhysRevLett.121.123601' : {'all' :      29, 'core' :       12},
          '10.1103/PhysRevB.97.195136' : {'all' :      29, 'core' :       12},
          '10.1103/PhysRevA.97.032501' : {'all' :      29, 'core' :       12},
          '10.1103/PhysRevA.100.062130' : {'all' :      29, 'core' :       12},
          '10.1103/PhysRevX.10.041012' : {'all' :      29, 'core' :       11},
          '10.1103/PhysRevApplied.10.044039' : {'all' :      29, 'core' :       11},
          '10.1103/PhysRevA.97.053846' : {'all' :      29, 'core' :       11},
          '10.1103/PhysRevResearch.2.033512' : {'all' :      29, 'core' :       10},
          '10.1103/PhysRevE.98.042123' : {'all' :      29, 'core' :       10},
          '10.1103/PhysRevE.101.062114' : {'all' :      29, 'core' :       10},
          '10.1103/PhysRevA.96.062107' : {'all' :      29, 'core' :       10},
          '10.1103/PhysRevResearch.2.013319' : {'all' :      28, 'core' :       20},
          '10.1103/PhysRevLett.127.040503' : {'all' :      28, 'core' :       20},
          '10.1103/PhysRevX.8.011018' : {'all' :      28, 'core' :       19},
          '10.1103/PhysRevA.97.062326' : {'all' :      28, 'core' :       18},
          '10.1103/PhysRevLett.121.170403' : {'all' :      28, 'core' :       17},
          '10.1103/PhysRevX.11.011028' : {'all' :      28, 'core' :       16},
          '10.1103/PhysRevA.103.052409' : {'all' :      28, 'core' :       15},
          '10.1103/PhysRevLett.124.160501' : {'all' :      28, 'core' :       14},
          '10.1103/PhysRevLett.123.170605' : {'all' :      28, 'core' :       12},
          '10.1103/PhysRevB.96.020408' : {'all' :      28, 'core' :       12},
          '10.1103/PhysRevA.99.010105' : {'all' :      28, 'core' :       12},
          '10.1103/PhysRevResearch.3.033043' : {'all' :      28, 'core' :       11},
          '10.1103/PhysRevLett.126.120503' : {'all' :      28, 'core' :       11},
          '10.1103/PhysRevApplied.9.034022' : {'all' :      28, 'core' :       11},
          '10.1103/PhysRevA.100.022108' : {'all' :      28, 'core' :       11},
          '10.1103/PhysRevLett.127.140602' : {'all' :      28, 'core' :       10},
          '10.1103/PhysRevLett.125.090503' : {'all' :      27, 'core' :       18},
          '10.1103/PhysRevLett.122.020503' : {'all' :      27, 'core' :       16},
          '10.1103/PhysRevLett.121.180505' : {'all' :      27, 'core' :       16},
          '10.1103/PhysRevApplied.13.034075' : {'all' :      27, 'core' :       15},
          '10.1103/PhysRevA.99.022317' : {'all' :      27, 'core' :       15},
          '10.1103/PhysRevLett.87.270404' : {'all' :      27, 'core' :       14},
          '10.1103/PhysRevLett.125.080403' : {'all' :      27, 'core' :       14},
          '10.1103/PhysRevLett.124.200503' : {'all' :      27, 'core' :       14},
          '10.1103/PhysRevLett.120.150501' : {'all' :      27, 'core' :       14},
          '10.1103/PhysRevLett.125.110401' : {'all' :      27, 'core' :       13},
          '10.1103/PhysRevA.98.022309' : {'all' :      27, 'core' :       13},
          '10.1103/PhysRevA.101.032114' : {'all' :      27, 'core' :       13},
          '10.1103/PhysRevLett.124.040404' : {'all' :      27, 'core' :       12},
          '10.1103/PhysRevResearch.1.033092' : {'all' :      27, 'core' :       11},
          '10.1103/PhysRevLett.124.137701' : {'all' :      27, 'core' :       11},
          '10.1103/PhysRevA.94.042342' : {'all' :      27, 'core' :       11},
          '10.1103/PhysRevLett.123.100604' : {'all' :      27, 'core' :       10},
          '10.1103/PhysRevB.103.L100403' : {'all' :      27, 'core' :       10},
          '10.1103/PhysRevA.97.062103' : {'all' :      27, 'core' :       10},
          '10.1103/PhysRevX.8.021047' : {'all' :      26, 'core' :       21},
          '10.1103/PhysRevA.100.012326' : {'all' :      26, 'core' :       20},
          '10.1103/PhysRevLett.120.230501' : {'all' :      26, 'core' :       19},
          '10.1103/PhysRevX.9.031022' : {'all' :      26, 'core' :       18},
          '10.1103/PhysRevA.95.052334' : {'all' :      26, 'core' :       17},
          '10.1103/PhysRevLett.125.190402' : {'all' :      26, 'core' :       16},
          '10.1103/PhysRevLett.125.043602' : {'all' :      26, 'core' :       16},
          '10.1103/PhysRevLett.122.010504' : {'all' :      26, 'core' :       16},
          '10.1103/PhysRevLett.120.240402' : {'all' :      26, 'core' :       16},
          '10.1103/PhysRevResearch.2.043102' : {'all' :      26, 'core' :       15},
          '10.1103/PhysRevLett.125.053001' : {'all' :      26, 'core' :       15},
          '10.1103/PhysRevResearch.2.023298' : {'all' :      26, 'core' :       14},
          '10.1103/PhysRevApplied.16.034013' : {'all' :      26, 'core' :       14},
          '10.1103/PhysRevA.99.032316' : {'all' :      26, 'core' :       14},
          '10.1103/PhysRevX.9.021039' : {'all' :      26, 'core' :       12},
          '10.1103/PhysRevResearch.2.033014' : {'all' :      26, 'core' :       12},
          '10.1103/PhysRevLett.121.180503' : {'all' :      26, 'core' :       12},
          '10.1103/RevModPhys.92.021001' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevResearch.2.033413' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevResearch.2.033315' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevResearch.2.023232' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevResearch.2.023026' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevLett.120.153602' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevB.103.125117' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevA.97.012332' : {'all' :      26, 'core' :       11},
          '10.1103/PhysRevB.102.100301' : {'all' :      26, 'core' :       10},
          '10.1103/PhysRevA.102.052223' : {'all' :      26, 'core' :       10},
          '10.1103/PhysRevLett.125.050501' : {'all' :      25, 'core' :       19},
          '10.1103/PhysRevApplied.16.024012' : {'all' :      25, 'core' :       19},
          '10.1103/PhysRevLett.119.060502' : {'all' :      25, 'core' :       18},
          '10.1103/PhysRevB.101.085117' : {'all' :      25, 'core' :       18},
          '10.1103/PhysRevA.102.032220' : {'all' :      25, 'core' :       18},
          '10.1103/PhysRevLett.124.210504' : {'all' :      25, 'core' :       17},
          '10.1103/PhysRevB.98.224305' : {'all' :      25, 'core' :       17},
          '10.1103/PhysRevLett.125.060503' : {'all' :      25, 'core' :       16},
          '10.1103/PhysRevA.103.L060401' : {'all' :      25, 'core' :       16},
          '10.1103/PhysRevLett.123.083601' : {'all' :      25, 'core' :       15},
          '10.1103/PhysRevX.11.031021' : {'all' :      25, 'core' :       14},
          '10.1103/PhysRevLett.121.250506' : {'all' :      25, 'core' :       14},
          '10.1103/PhysRevResearch.2.023005' : {'all' :      25, 'core' :       13},
          '10.1103/PhysRevLett.119.070401' : {'all' :      25, 'core' :       13},
          '10.1103/PhysRevApplied.11.064068' : {'all' :      25, 'core' :       13},
          '10.1103/PhysRevLett.124.120403' : {'all' :      25, 'core' :       12},
          '10.1103/PhysRevLett.125.110402' : {'all' :      25, 'core' :       11},
          '10.1103/PhysRevLett.124.067701' : {'all' :      25, 'core' :       11},
          '10.1103/PhysRevB.99.161203' : {'all' :      25, 'core' :       11},
          '10.1103/PhysRevLett.91.083601' : {'all' :      25, 'core' :       10},
          '10.1103/PhysRevLett.126.050503' : {'all' :      25, 'core' :       10},
          '10.1103/PhysRevLett.126.023603' : {'all' :      25, 'core' :       10},
          '10.1103/PhysRevLett.124.043402' : {'all' :      25, 'core' :       10},
          '10.1103/PhysRevLett.120.093201' : {'all' :      25, 'core' :       10},
          '10.1103/PhysRevE.103.042118' : {'all' :      25, 'core' :       10},
          '10.1103/PhysRevX.8.021059' : {'all' :      24, 'core' :       19},
          '10.1103/PhysRevB.96.220501' : {'all' :      24, 'core' :       19},
          '10.1103/PhysRevLett.122.200401' : {'all' :      24, 'core' :       18},
          '10.1103/PhysRevA.95.012301' : {'all' :      24, 'core' :       18},
          '10.1103/PhysRevA.100.042304' : {'all' :      24, 'core' :       18},
          '10.1103/PhysRevResearch.2.043130' : {'all' :      24, 'core' :       17},
          '10.1103/PhysRevLett.120.113602' : {'all' :      24, 'core' :       17},
          '10.1103/PhysRevA.103.012404' : {'all' :      24, 'core' :       17},
          '10.1103/PhysRevA.102.032215' : {'all' :      24, 'core' :       17},
          '10.1103/PhysRevB.100.134504' : {'all' :      24, 'core' :       16},
          '10.1103/PhysRevA.97.062346' : {'all' :      24, 'core' :       16},
          '10.1103/PhysRevLett.123.133602' : {'all' :      24, 'core' :       15},
          '10.1103/PhysRevLett.119.240403' : {'all' :      24, 'core' :       15},
          '10.1103/PhysRevPhysEducRes.16.020131' : {'all' :      24, 'core' :       14},
          '10.1103/PhysRevA.98.022119' : {'all' :      24, 'core' :       14},
          '10.1103/PhysRevLett.125.247702' : {'all' :      24, 'core' :       13},
          '10.1103/PhysRevLett.120.063604' : {'all' :      24, 'core' :       13},
          '10.1103/PhysRevApplied.11.044063' : {'all' :      24, 'core' :       13},
          '10.1103/PhysRevLett.127.070401' : {'all' :      24, 'core' :       12},
          '10.1103/PhysRevLett.127.050501' : {'all' :      24, 'core' :       12},
          '10.1103/PhysRevLett.126.200501' : {'all' :      24, 'core' :       12},
          '10.1103/PhysRevLett.101.260404' : {'all' :      24, 'core' :       12},
          '10.1103/PhysRevResearch.3.023079' : {'all' :      24, 'core' :       11},
          '10.1103/PhysRevLett.122.250403' : {'all' :      24, 'core' :       11},
          '10.1103/PhysRevApplied.15.024049' : {'all' :      24, 'core' :       11},
          '10.1103/PhysRevX.9.031029' : {'all' :      24, 'core' :       10},
          '10.1103/PhysRevB.96.165306' : {'all' :      24, 'core' :       10},
          '10.1103/PhysRevLett.124.020502' : {'all' :      23, 'core' :       20},
          '10.1103/PhysRevA.99.012301' : {'all' :      23, 'core' :       19},
          '10.1103/PhysRevLett.125.040502' : {'all' :      23, 'core' :       17},
          '10.1103/PhysRevLett.119.120504' : {'all' :      23, 'core' :       17},
          '10.1103/PhysRevApplied.8.054015' : {'all' :      23, 'core' :       17},
          '10.1103/PhysRevA.98.062336' : {'all' :      23, 'core' :       17},
          '10.1103/PhysRevX.8.041032' : {'all' :      23, 'core' :       16},
          '10.1103/PhysRevLett.121.030501' : {'all' :      23, 'core' :       16},
          '10.1103/PhysRevLett.121.183601' : {'all' :      23, 'core' :       15},
          '10.1103/PhysRevApplied.14.044055' : {'all' :      23, 'core' :       15},
          '10.1103/PhysRevResearch.2.023030' : {'all' :      23, 'core' :       14},
          '10.1103/PhysRevX.10.021022' : {'all' :      23, 'core' :       13},
          '10.1103/PhysRevResearch.4.013148' : {'all' :      23, 'core' :       13},
          '10.1103/PhysRevLett.123.170402' : {'all' :      23, 'core' :       13},
          '10.1103/PhysRevLett.122.050402' : {'all' :      23, 'core' :       13},
          '10.1103/PhysRevResearch.2.023327' : {'all' :      23, 'core' :       12},
          '10.1103/PhysRevLett.124.240402' : {'all' :      23, 'core' :       12},
          '10.1103/PhysRevLett.119.193602' : {'all' :      23, 'core' :       12},
          '10.1103/PhysRevB.100.125430' : {'all' :      23, 'core' :       12},
          '10.1103/PhysRevA.102.042607' : {'all' :      23, 'core' :       12},
          '10.1103/PhysRevResearch.2.033083' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevLett.124.120502' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevLett.120.020504' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevA.98.020101' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevA.97.052333' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevA.97.022109' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevA.102.060201' : {'all' :      23, 'core' :       11},
          '10.1103/PhysRevLett.127.037201' : {'all' :      23, 'core' :       10},
          '10.1103/PhysRevLett.120.073001' : {'all' :      23, 'core' :       10},
          '10.1103/PhysRevB.99.134426' : {'all' :      23, 'core' :       10},
          '10.1103/PhysRevA.100.062335' : {'all' :      22, 'core' :       20},
          '10.1103/PRXQuantum.2.020340' : {'all' :      22, 'core' :       19},
          '10.1103/PhysRevLett.127.020504' : {'all' :      22, 'core' :       19},
          '10.1103/PhysRevA.100.022339' : {'all' :      22, 'core' :       19},
          '10.1103/PhysRevResearch.3.033275' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevLett.125.160501' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevLett.124.033603' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevApplied.14.064009' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevApplied.13.064012' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevA.102.062425' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevA.101.052302' : {'all' :      22, 'core' :       18},
          '10.1103/PhysRevApplied.13.054041' : {'all' :      22, 'core' :       17},
          '10.1103/PhysRevLett.118.210502' : {'all' :      22, 'core' :       16},
          '10.1103/PhysRevA.96.032318' : {'all' :      22, 'core' :       16},
          '10.1103/PhysRevResearch.3.013077' : {'all' :      22, 'core' :       15},
          '10.1103/PhysRevLett.123.060502' : {'all' :      22, 'core' :       15},
          '10.1103/PhysRevLett.120.073603' : {'all' :      22, 'core' :       15},
          '10.1103/PhysRevA.104.032610' : {'all' :      22, 'core' :       15},
          '10.1103/PhysRevA.101.042340' : {'all' :      22, 'core' :       15},
          '10.1103/PhysRevA.104.052418' : {'all' :      22, 'core' :       14},
          '10.1103/PhysRevLett.124.200501' : {'all' :      22, 'core' :       13},
          '10.1103/PhysRevLett.124.170502' : {'all' :      22, 'core' :       13},
          '10.1103/PhysRevB.98.245424' : {'all' :      22, 'core' :       13},
          '10.1103/PhysRevA.99.032335' : {'all' :      22, 'core' :       13},
          '10.1103/PhysRevA.96.012302' : {'all' :      22, 'core' :       13},
          '10.1103/PhysRevLett.125.263602' : {'all' :      22, 'core' :       12},
          '10.1103/PhysRevLett.121.110403' : {'all' :      22, 'core' :       12},
          '10.1103/PhysRevA.95.062315' : {'all' :      22, 'core' :       12},
          '10.1103/PhysRevResearch.2.032052' : {'all' :      22, 'core' :       11},
          '10.1103/PhysRevLett.125.020501' : {'all' :      22, 'core' :       11},
          '10.1103/PhysRevApplied.10.014018' : {'all' :      22, 'core' :       11},
          '10.1103/PhysRevLett.124.210502' : {'all' :      22, 'core' :       10},
          '10.1103/PhysRevLett.123.100502' : {'all' :      22, 'core' :       10},
          '10.1103/PhysRevLett.121.080407' : {'all' :      22, 'core' :       10},
          '10.1103/PhysRevA.98.012101' : {'all' :      22, 'core' :       10},
          '10.1103/PhysRevA.102.042202' : {'all' :      22, 'core' :       10},
          '10.1103/PhysRevA.91.042320' : {'all' :      21, 'core' :       21},
          '10.1103/PhysRevA.103.032607' : {'all' :      21, 'core' :       20},
          '10.1103/PRXQuantum.3.010334' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevLett.124.117701' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevLett.123.190501' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevApplied.15.064054' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevA.99.052346' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevA.97.032312' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevA.96.062321' : {'all' :      21, 'core' :       19},
          '10.1103/PhysRevA.99.053830' : {'all' :      21, 'core' :       18},
          '10.1103/PhysRevA.97.052308' : {'all' :      21, 'core' :       18},
          '10.1103/PhysRevLett.119.050503' : {'all' :      21, 'core' :       17},
          '10.1103/PhysRevX.8.021001' : {'all' :      21, 'core' :       16},
          '10.1103/PhysRevApplied.14.054033' : {'all' :      21, 'core' :       16},
          '10.1103/PhysRevApplied.12.024062' : {'all' :      21, 'core' :       16},
          '10.1103/PhysRevA.98.012312' : {'all' :      21, 'core' :       16},
          '10.1103/PhysRevX.11.031044' : {'all' :      21, 'core' :       15},
          '10.1103/PhysRevA.99.052321' : {'all' :      21, 'core' :       15},
          '10.1103/PhysRevA.100.022316' : {'all' :      21, 'core' :       15},
          '10.1103/PhysRevX.11.011032' : {'all' :      21, 'core' :       14},
          '10.1103/PhysRevLett.127.040502' : {'all' :      21, 'core' :       14},
          '10.1103/PhysRevLett.125.030506' : {'all' :      21, 'core' :       14},
          '10.1103/PhysRevLett.121.170502' : {'all' :      21, 'core' :       14},
          '10.1103/PhysRevB.100.041304' : {'all' :      21, 'core' :       14},
          '10.1103/PhysRevResearch.3.023190' : {'all' :      21, 'core' :       13},
          '10.1103/PhysRevLett.123.040402' : {'all' :      21, 'core' :       13},
          '10.1103/PhysRevA.97.052321' : {'all' :      21, 'core' :       13},
          '10.1103/PhysRevA.68.042301' : {'all' :      21, 'core' :       13},
          '10.1103/PhysRevA.102.012607' : {'all' :      21, 'core' :       13},
          '10.1103/PhysRevB.98.155319' : {'all' :      21, 'core' :       12},
          '10.1103/PhysRevA.96.011602' : {'all' :      21, 'core' :       12},
          '10.1103/PhysRevA.103.L040401' : {'all' :      21, 'core' :       12},
          '10.1103/PRXQuantum.3.010306' : {'all' :      21, 'core' :       11},
          '10.1103/PhysRevResearch.2.023414' : {'all' :      21, 'core' :       11},
          '10.1103/PhysRevLett.125.133602' : {'all' :      21, 'core' :       11},
          '10.1103/PhysRevA.96.023818' : {'all' :      21, 'core' :       11},
          '10.1103/PhysRevX.11.021029' : {'all' :      21, 'core' :       10},
          '10.1103/PhysRevLett.125.233605' : {'all' :      21, 'core' :       10},
          '10.1103/PhysRevApplied.12.014015' : {'all' :      21, 'core' :       10},
          '10.1103/PhysRevA.95.062327' : {'all' :      21, 'core' :       10},
          '10.1103/PhysRevA.101.031801' : {'all' :      21, 'core' :       10},
          '10.1103/PhysRevLett.120.200502' : {'all' :      20, 'core' :       19},
          '10.1103/PhysRevApplied.12.014044' : {'all' :      20, 'core' :       19},
          '10.1103/PhysRevA.99.022330' : {'all' :      20, 'core' :       19},
          '10.1103/PhysRevA.100.032308' : {'all' :      20, 'core' :       19},
          '10.1103/PhysRevA.99.062337' : {'all' :      20, 'core' :       18},
          '10.1103/PhysRevLett.125.080504' : {'all' :      20, 'core' :       17},
          '10.1103/PhysRevLett.122.240501' : {'all' :      20, 'core' :       17},
          '10.1103/PhysRevA.98.042315' : {'all' :      20, 'core' :       17},
          '10.1103/PhysRevA.100.062315' : {'all' :      20, 'core' :       17},
          '10.1103/PhysRevLett.126.230501' : {'all' :      20, 'core' :       16},
          '10.1103/PhysRevApplied.15.064074' : {'all' :      20, 'core' :       16},
          '10.1103/PhysRevA.96.062303' : {'all' :      20, 'core' :       16},
          '10.1103/PhysRevLett.125.040501' : {'all' :      20, 'core' :       15},
          '10.1103/PhysRevX.8.011038' : {'all' :      20, 'core' :       14},
          '10.1103/PhysRevLett.128.126803' : {'all' :      20, 'core' :       14},
          '10.1103/PhysRevLett.126.230403' : {'all' :      20, 'core' :       14},
          '10.1103/PhysRevA.98.022310' : {'all' :      20, 'core' :       14},
          '10.1103/PhysRevX.11.021014' : {'all' :      20, 'core' :       13},
          '10.1103/PhysRevLett.123.030501' : {'all' :      20, 'core' :       13},
          '10.1103/PhysRevB.97.060508' : {'all' :      20, 'core' :       13},
          '10.1103/PhysRevApplied.15.054001' : {'all' :      20, 'core' :       13},
          '10.1103/PhysRevLett.125.120605' : {'all' :      20, 'core' :       12},
          '10.1103/PhysRevB.99.075430' : {'all' :      20, 'core' :       12},
          '10.1103/PhysRevLett.125.093603' : {'all' :      20, 'core' :       11},
          '10.1103/PhysRevLett.124.230504' : {'all' :      20, 'core' :       11},
          '10.1103/PhysRevLett.120.223603' : {'all' :      20, 'core' :       11},
          '10.1103/PhysRevB.102.195418' : {'all' :      20, 'core' :       11},
          '10.1103/PhysRevA.98.012322' : {'all' :      20, 'core' :       11},
          '10.1103/PRXQuantum.2.020315' : {'all' :      20, 'core' :       10},
          '10.1103/PhysRevX.10.041025' : {'all' :      20, 'core' :       10},
          '10.1103/PhysRevLett.121.173603' : {'all' :      20, 'core' :       10},
          '10.1103/PhysRevB.100.081412' : {'all' :      20, 'core' :       10},
          '10.1103/PhysRevApplied.15.044033' : {'all' :      20, 'core' :       10},
          '10.1103/PhysRevA.98.050101' : {'all' :      20, 'core' :       10},
          '10.1103/PhysRevA.96.033826' : {'all' :      20, 'core' :       10},
          '10.1103/PRXQuantum.2.020325' : {'all' :      19, 'core' :       18},
          '10.1103/PhysRevResearch.3.033230' : {'all' :      19, 'core' :       18},
          '10.1103/PhysRevApplied.15.054012' : {'all' :      19, 'core' :       18},
          '10.1103/PhysRevApplied.14.044039' : {'all' :      19, 'core' :       18},
          '10.1103/PhysRevA.96.032341' : {'all' :      19, 'core' :       18},
          '10.1103/PhysRevApplied.9.054008' : {'all' :      19, 'core' :       17},
          '10.1103/PhysRevA.99.052351' : {'all' :      19, 'core' :       17},
          '10.1103/PhysRevA.98.032335' : {'all' :      19, 'core' :       17},
          '10.1103/PhysRevA.97.022332' : {'all' :      19, 'core' :       17},
          '10.1103/PhysRevA.102.052408' : {'all' :      19, 'core' :       17},
          '10.1103/PhysRevX.8.021058' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevApplied.16.024023' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevApplied.14.014100' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevApplied.13.034017' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevA.104.L030401' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevA.102.022408' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevA.100.032316' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevA.100.012330' : {'all' :      19, 'core' :       16},
          '10.1103/PhysRevLett.127.110505' : {'all' :      19, 'core' :       15},
          '10.1103/PhysRevLett.127.010504' : {'all' :      19, 'core' :       15},
          '10.1103/PhysRevLett.126.210501' : {'all' :      19, 'core' :       15},
          '10.1103/PhysRevA.97.062330' : {'all' :      19, 'core' :       15},
          '10.1103/PhysRevA.100.022517' : {'all' :      19, 'core' :       15},
          '10.1103/PhysRevLett.126.230504' : {'all' :      19, 'core' :       14},
          '10.1103/PhysRevLett.125.100401' : {'all' :      19, 'core' :       14},
          '10.1103/PhysRevApplied.12.044020' : {'all' :      19, 'core' :       14},
          '10.1103/PhysRevA.97.052317' : {'all' :      19, 'core' :       14},
          '10.1103/PhysRevA.102.032408' : {'all' :      19, 'core' :       14},
          '10.1103/PhysRevA.100.032315' : {'all' :      19, 'core' :       14},
          '10.1103/PhysRevLett.126.100501' : {'all' :      19, 'core' :       13},
          '10.1103/PhysRevLett.124.060501' : {'all' :      19, 'core' :       13},
          '10.1103/PhysRevLett.122.217702' : {'all' :      19, 'core' :       13},
          '10.1103/PhysRevLett.122.163201' : {'all' :      19, 'core' :       13},
          '10.1103/PhysRevLett.120.060502' : {'all' :      19, 'core' :       13},
          '10.1103/PhysRevResearch.3.013194' : {'all' :      19, 'core' :       12},
          '10.1103/PhysRevLett.121.050501' : {'all' :      19, 'core' :       12},
          '10.1103/PhysRevApplied.13.034029' : {'all' :      19, 'core' :       11},
          '10.1103/PhysRevA.101.012346' : {'all' :      19, 'core' :       11},
          '10.1103/PhysRevLett.121.040505' : {'all' :      19, 'core' :       10},
          '10.1103/PhysRevA.98.042311' : {'all' :      19, 'core' :       10},
          '10.1103/PhysRevResearch.3.013274' : {'all' :      18, 'core' :       18},
          '10.1103/PhysRevApplied.16.014067' : {'all' :      18, 'core' :       17},
          '10.1103/PhysRevApplied.15.034068' : {'all' :      18, 'core' :       17},
          '10.1103/PhysRevResearch.3.013197' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevLett.122.230501' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevApplied.13.024059' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevA.99.052350' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevA.97.062322' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevA.101.062331' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevA.101.062306' : {'all' :      18, 'core' :       16},
          '10.1103/PhysRevLett.125.110503' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevLett.123.070507' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevLett.120.050504' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevApplied.14.054057' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevA.99.042314' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevA.98.042326' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevA.96.043856' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevA.103.022424' : {'all' :      18, 'core' :       15},
          '10.1103/PhysRevB.100.024302' : {'all' :      18, 'core' :       14},
          '10.1103/PhysRevA.99.042334' : {'all' :      18, 'core' :       14},
          '10.1103/PhysRevA.103.032615' : {'all' :      18, 'core' :       14},
          '10.1103/PhysRevResearch.2.043374' : {'all' :      18, 'core' :       12},
          '10.1103/PhysRevLett.122.100501' : {'all' :      18, 'core' :       12},
          '10.1103/PhysRevLett.122.070501' : {'all' :      18, 'core' :       12},
          '10.1103/PhysRevA.99.032311' : {'all' :      18, 'core' :       12},
          '10.1103/PhysRevA.103.012601' : {'all' :      18, 'core' :       12},
          '10.1103/PhysRevA.102.053720' : {'all' :      18, 'core' :       12},
          '10.1103/PhysRevLett.122.200601' : {'all' :      18, 'core' :       11},
          '10.1103/PhysRevB.98.195444' : {'all' :      18, 'core' :       11},
          '10.1103/PhysRevApplied.13.024014' : {'all' :      18, 'core' :       11},
          '10.1103/PhysRevApplied.11.034044' : {'all' :      18, 'core' :       11},
          '10.1103/PhysRevLett.120.203601' : {'all' :      18, 'core' :       10},
          '10.1103/PhysRevApplied.10.044019' : {'all' :      18, 'core' :       10},
          '10.1103/PhysRevApplied.8.064004' : {'all' :      17, 'core' :       17},
          '10.1103/PhysRevB.97.064508' : {'all' :      17, 'core' :       16},
          '10.1103/PhysRevA.99.012320' : {'all' :      17, 'core' :       16},
          '10.1103/PhysRevA.103.042415' : {'all' :      17, 'core' :       16},
          '10.1103/PhysRevX.8.021060' : {'all' :      17, 'core' :       15},
          '10.1103/PhysRevResearch.2.023270' : {'all' :      17, 'core' :       15},
          '10.1103/PhysRevLett.127.060505' : {'all' :      17, 'core' :       15},
          '10.1103/PhysRevLett.126.220503' : {'all' :      17, 'core' :       15},
          '10.1103/PhysRevA.102.052414' : {'all' :      17, 'core' :       15},
          '10.1103/PhysRevA.101.012342' : {'all' :      17, 'core' :       15},
          '10.1103/PhysRevX.11.031009' : {'all' :      17, 'core' :       14},
          '10.1103/PhysRevApplied.13.054002' : {'all' :      17, 'core' :       14},
          '10.1103/PhysRevA.97.052327' : {'all' :      17, 'core' :       14},
          '10.1103/PhysRevA.102.022619' : {'all' :      17, 'core' :       14},
          '10.1103/PhysRevLett.124.240502' : {'all' :      17, 'core' :       13},
          '10.1103/PhysRevApplied.8.044017' : {'all' :      17, 'core' :       13},
          '10.1103/PhysRevApplied.11.054056' : {'all' :      17, 'core' :       13},
          '10.1103/PhysRevA.102.052402' : {'all' :      17, 'core' :       13},
          '10.1103/PhysRevX.8.021072' : {'all' :      17, 'core' :       12},
          '10.1103/PhysRevLett.121.130501' : {'all' :      17, 'core' :       12},
          '10.1103/PhysRevApplied.15.034003' : {'all' :      17, 'core' :       12},
          '10.1103/PhysRevA.98.062338' : {'all' :      17, 'core' :       12},
          '10.1103/PhysRevA.103.032408' : {'all' :      17, 'core' :       12},
          '10.1103/PhysRevX.8.041018' : {'all' :      17, 'core' :       11},
          '10.1103/PhysRevX.8.031020' : {'all' :      17, 'core' :       11},
          '10.1103/PhysRevLett.127.043604' : {'all' :      17, 'core' :       11},
          '10.1103/PhysRevLett.126.210506' : {'all' :      17, 'core' :       11},
          '10.1103/PhysRevLett.122.020601' : {'all' :      17, 'core' :       11},
          '10.1103/PhysRevLett.119.110501' : {'all' :      17, 'core' :       11},
          '10.1103/PhysRevResearch.2.033205' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevLett.126.013602' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevLett.121.230401' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevLett.120.213602' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevLett.120.020506' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevApplied.13.044008' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevA.102.063715' : {'all' :      17, 'core' :       10},
          '10.1103/PhysRevA.97.022335' : {'all' :      16, 'core' :       16},
          '10.1103/PhysRevApplied.13.024008' : {'all' :      16, 'core' :       14},
          '10.1103/PhysRevA.99.052309' : {'all' :      16, 'core' :       14},
          '10.1103/PhysRevA.96.030301' : {'all' :      16, 'core' :       14},
          '10.1103/PhysRevLett.127.050503' : {'all' :      16, 'core' :       13},
          '10.1103/PhysRevA.99.052304' : {'all' :      16, 'core' :       13},
          '10.1103/PhysRevA.100.032304' : {'all' :      16, 'core' :       13},
          '10.1103/PhysRevA.97.062334' : {'all' :      16, 'core' :       12},
          '10.1103/PhysRevLett.124.140503' : {'all' :      16, 'core' :       11},
          '10.1103/PhysRevA.104.042421' : {'all' :      16, 'core' :       11},
          '10.1103/PhysRevA.95.061803' : {'all' :      16, 'core' :       10},
          '10.1103/PhysRevA.103.012610' : {'all' :      16, 'core' :       10},
          '10.1103/PhysRevLett.125.180501' : {'all' :      15, 'core' :       14},
          '10.1103/PhysRevA.104.013703' : {'all' :      13, 'core' :       10}}


dois = list(sample.keys())
jnlfilename = 'APS_QIS_retro_sample.' + ejlmod3.stampoftoday()
if skipalreadyharvested:
    alreadyharvested = ejlmod3.getalreadyharvested('APS_QIS_retro_sample')


recnr = 0
subject = ''
recs = []
for doi in dois:
    recnr += 1
    ejlmod3.printprogress('-', [[recnr, len(dois)], [doi], [sample[doi]['core'], sample[doi]['all']]])
    if sample[doi]['core'] < corethreshold:
        print('   too, few citations')
        continue
    if skipalreadyharvested and doi in alreadyharvested:
        print('   already in backup')
        continue
    if re.search('PhysRevAppl', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/prapplied/abstract/10.1103/PhysRevAppl' + doi[19:]
    elif re.search('PhysRev[A-Z].\d', doi, re.IGNORECASE):
        letter = doi[15].lower()
        artlink = 'https://journals.aps.org/pr%s/abstract/%s' % (letter, '10.1103/PhysRev' + doi[15:].upper())
    elif re.search('PhysRev\.', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/pr/abstract/' + '10.1103/PhysRev' + doi[15:]
    elif re.search('PhysRevLett', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/prl/abstract/10.1103/PhysRevLett' + doi[19:]
    elif re.search('PhysRevAccelBeams', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/prab/abstract/10.1103/PhysRevAccelBeams' + doi[25:]
    elif re.search('PRXQuantum', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/prxquantum/abstract/10.1103/PRXQuantum' + doi[19:]
    elif re.search('RevModPhys', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/rmp/abstract/10.1103/RevModPhys' + doi[18:]
    elif re.search('PhysRevResearch', doi, re.IGNORECASE):
        artlink = 'https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch' + doi[23:]
    else:
        print('??? can not create article link for', doi)
        #continue
        sys.exit(0)
    print(' -', artlink)
    try:
        page = BeautifulSoup(urllib.request.urlopen(artlink), features='lxml')
    except:
        try:
            print(' - sleep 5minutes')
            time.sleep(300)
            page = BeautifulSoup(urllib.request.urlopen(artlink), features='lxml')
        except:
            print(' - probleme')
            continue
    rec = {'doi' : doi, 'autaff' : [], 'tc' : 'P', 'keyw' : []}
    ejlmod3.metatagcheck(rec, page, ['citation_title', 'citation_date', 'citation_volume',
                                     'citation_issue', 'citation_firstpage', 'citation_author',
                                     'citation_author_institution']) #'description' contains first paragrapg of paper or so instead of abstract
    #abstract
    divs = page.body.find_all('div', attrs = {'class' : 'content', 'data-loaded' : 'yes'})
    if divs:
        for ul in divs[0].find_all('ul'):
            ul.replace_with('XXXFFF')            
        rec['abs'] = re.sub('XXXFFF.*', '', divs[0].text.strip())
    for meta in page.head.find_all('meta'):
        if 'name' in meta.attrs:
            if meta['name'] == 'citation_journal_abbrev':
                rec['jnl'] = re.sub(' +', '', meta['content'])
            elif meta['name'] == 'citation_journal_title':
                if meta['content'] == 'PRXQuantum':
                    rec['jnl'] = 'PRX Quantum'
                else:
                    rec['jnl'] = meta['content']                    
    for span in page.body.find_all('span', attrs = {'class' : 'physh-discipline'}):
        rec['keyw'].append(span.text.strip())
    for a in page.body.find_all('a', attrs = {'class' : 'physh-concept'}):
        rec['keyw'].append(a.text.strip())
        

    ejlmod3.globallicensesearch(rec, page)
    time.sleep(10)
    reflink = re.sub('abstract', 'references', artlink)
    refpage = BeautifulSoup(urllib.request.urlopen(reflink), features='lxml')
    for ol in refpage.find_all('ol', attrs = {'class' : 'references'}):
        rec['refs'] = []
        for li in ol.find_all('li'):
            rdoi = False
            for a in li.find_all('a'):
                if a.has_attr('href'):
                    link = a['href']
                    if re.search('doi.org.10', link):
                        rdoi = re.sub('.*?(10\.\d+\/.*)', r'\1', link)
            ref = li.text
            if rdoi:
                ref = re.sub('\. *$', '', ref)
                ref += ', DOI: %s.' % (rdoi)
            rec['refs'].append([('x', ref)])

    #sample note
    rec['note'] = ['reharvest_based_on_refanalysis',
                   '%i citations from INSPIRE papers' % (sample[doi]['all']),
                   '%i citations from CORE INSPIRE papers' % (sample[doi]['core'])]

    #author fall back
    if not rec['autaff']:
        explink = re.sub('abstract', 'export', artlink)
        time.sleep(10)
        exppage = re.sub('[\n\r\t]', ' ', str(urllib.request.urlopen(explink).read()))
        authors = re.sub('.*author = {(.*?)}.*', r'\1', exppage)
        #print(authors)
        for author in re.split(' and ', authors):
            rec['autaff'].append([author])
        
    
    if 'tit' in rec:
        recs.append(rec)
        ejlmod3.printrecsummary(rec)

    ejlmod3.writenewXML(recs[((len(recs)-1) // bunchsize)*bunchsize:], publisher, jnlfilename + '--%04i' % (1 + (len(recs)-1) // bunchsize), retfilename='retfiles_special')

    print('\n-------------------------\n--- sleep %3i seconds ---\n-------------------------\n' % (sleeptime))
    time.sleep(sleeptime)


